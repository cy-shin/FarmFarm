# FarmFarm
> 농자재 쇼핑몰, 작물 거래 중개 플랫폼

</br>

## 1. 제작 기간 & 참여 인원
- 2022.12.13 ~ 2023.01.11
- 팀프로젝트, 6명

</br>

## 2. 사용 기술

> #### Back-end
- Java 11
- Spring 3.9.18
- Maven
- Oracle 21C
- Apache Tomcat 9.0
- Spring Security
- Mybatis

</br>

> #### Front-end
- HTML/CSS
- Javascript

</br>

## 3. ERD 설계
<img width="80%" src="https://github.com/cy-shin/FarmFarm/blob/16b4e3c232a17d9e0596a3f17a727d6a2150019e/FarmFarm%20ERD.png"/>


</br>


## 4. 핵심 기능
<details>
<summary> 핵심 기능 내용 보기 </summary>

### 4.1 상품 목록 페이지

<img width="80%" src="https://github.com/cy-shin/FarmFarm/blob/e4b5f39c07027e61a418a5fab0ee801b5d1a11ac/%ED%95%B5%EC%8B%AC%20%EA%B8%B0%EB%8A%A5%20%EC%9D%B4%EB%AF%B8%EC%A7%80/%EC%83%81%ED%92%88%EB%AA%A9%EB%A1%9D%ED%8E%98%EC%9D%B4%EC%A7%80.png"/>

- 카테고리 선택, 검색, 상품 정렬 및 품절 제외 옵션, 페이지네이션 비동기 방식으로 구현
- 비동기 요청 시 화면 중앙에 스피너를 출력하여 이용자에게 요청이 처리되고 있음을 알림
- 스크롤이 일정 길이 이상 내려올 경우, 상단 nav바에 검색창을 표시
- 상품 선택 시, 해당 상품의 상세 페이지로 이동
- 품절 상품의 경우 상품 썸네일 이미지에 별도 표시
- history.pushState()를 이용해 뒤로가기 클릭 시 이전 비동기 요청 결과를 불러옴

</br>

#### 4.2 채팅 기능

<img width="80%" src="https://github.com/cy-shin/FarmFarm/blob/e4b5f39c07027e61a418a5fab0ee801b5d1a11ac/%ED%95%B5%EC%8B%AC%20%EA%B8%B0%EB%8A%A5%20%EC%9D%B4%EB%AF%B8%EC%A7%80/%EC%B1%84%ED%8C%85%20%EC%98%88%EC%8B%9C.png"/>

- 상품 상세 페이지에서 '상품 문의하기' 버튼 클릭 시, 판매자와의 1:1 채팅방 개설(좌)
- 채팅 센터 내 '새 채팅 개설하기' 선택 시 단체 채팅방 개설(우)
- 단체 채팅방 개설 후, 타 회원의 닉네임으로 해당 회원을 초대할 수 있음
- 채팅방 내 이미지 및 등록되어 있는 간단한 이모티콘 전송 가능
- 채팅방 외부에서 채팅 수신 시, 우하단 채팅 위젯에 뱃지 표시

</br>

#### 4.3 알림 기능

<img width="80%" src="https://github.com/cy-shin/FarmFarm/blob/e4b5f39c07027e61a418a5fab0ee801b5d1a11ac/%ED%95%B5%EC%8B%AC%20%EA%B8%B0%EB%8A%A5%20%EC%9D%B4%EB%AF%B8%EC%A7%80/%EC%95%8C%EB%A6%BC%EC%84%BC%ED%84%B0.png"/>

- 웹소켓, Sock.js 라이브러리를 이용해 알림 기능 구현
- 상품 주문 및 배송 시작, 작성한 커뮤니티 게시글에 새 댓글이 달린 경우, 채팅방 초대 시 알림 수신
- 알림 수신 시 화면 우하단에 알림 푸시가 잠시 표시되고, 상단 알림 위젯 버튼에 뱃지 표시
- 상단 알림 위젯 또는 알림 센터에서 수신한 알림 조회 및 관리 가능
- 알림 선택 시 관련 페이지로 이동
- 확인한 알림은 흐리게 표시

</details>
</br>


## 5. 트러블 슈팅
<details>
<summary> 이미지가 의도한 경로에 저장되지 않던 문제 </summary>
- 채팅 중 이미지 전송 시 프로젝트 내에 있는 별도의 폴더에 저장되게 입력했는데, 해당 경로에서 파일을 찾을 수 없었습니다.
</br>
- 확인 결과 이미지 파일이 의도한 경로가 아닌, 톰캣 배포 경로 내에 있는 폴더에 저장되고 있었습니다. 
</br> </br>
- 톰캣 서버의 설정 중 'Serve Modules without publishing'이 체크 해제되어 있어 체크하여 해결했습니다.
</br>
- 해당 설정은 프로젝트의 파일들을 따로 배포하는대신 현재 경로에 있는 파일 직접 참조하게 하는 설정입니다.

</details>


<details>
<summary> 채팅 날짜 출력 오류 </summary>
- 현재 날짜에 처음으로 채팅을 보낸 경우, 구분선과 함께 현재 날짜가 표시되게 했는데 연, 월까지는 정상적으로 출력이 되었지만 일자가 잘못 출력되었습니다.
</br>
- 확인 결과 날짜를 생성하기 위해 작성한 패턴 문자가 잘못 입력되어 있었습니다. 월간 기준 날짜 패턴(dd) 대신 연간 기준 날짜 패턴(DD)이 입력되어 있었습니다.
</br>
- 해당 기능을 작성한 시점은 1월이어서 문제를 확인하지 못했으나, 추후 확인하여 해결하였습니다.

</details>

<details>
<summary> 사진 삭제 오류 </summary>
- 사진 형식의 채팅 전송 직후에만 해당 채팅이 삭제되지 않았습니다. 채팅 목록을 다시 불러온 이후에는 정상적으로 삭제할 수 있었습니다.
</br>
- 채팅 삭제 시 채팅번호를 컨트롤러로 전송해 삭제를 요청했는데, 사진 형식의 채팅 전송 직후에는 채팅번호를 가져오지 않아서 생긴 현상이었습니다.
</br></br>
- 채팅번호와 이미지경로를 한 번에 가져오기 위해 서비스 단에서 두 값을 map에 담은 후 가져왔으나 이번에는
</br>
  <strong>"디코드된 텍스트 메시지가 출력 버퍼에 비해 너무 크며, 해당 엔드포인트는 partial 메시지들을 지원하지 않습니다."</strong>라는 메세지와 함께 웹소켓 서버가 강제 종료 후 재실행되는 문제가 발생했습니다.
</br></br>
- map 대신 list에 담은 후 가져와 해결했습니다.

</details>



</br>
